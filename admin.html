<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel - LuxeThreads Studio</title>
<style>
    body { font-family: Arial, sans-serif; background-color: #f5f5f5; margin:0; padding:0; }
    header { background-color: #222; color:white; padding:20px; text-align:center; }
    nav { background-color:#333; overflow:hidden; }
    nav a { float:left; display:block; color:#fff; text-align:center; padding:14px 20px; text-decoration:none; }
    nav a:hover { background-color:#555; }
    main { padding:20px; }
    h2 { color:#333; }
    .card { background:#fff; padding:20px; margin-bottom:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1);}
    input, select, textarea { width:100%; padding:10px; margin:6px 0 12px 0; border:1px solid #ccc; border-radius:4px; }
    button { background-color:#222; color:white; padding:10px 20px; border:none; border-radius:4px; cursor:pointer; }
    button:hover { background-color:#555; }
    #productsContainer div { margin-bottom: 12px; border-bottom:1px solid #ccc; padding-bottom:8px; }
</style>
</head>
<body>

<header>
    <h1>LuxeThreads Studio - Admin Panel</h1>
</header>

<nav>
    <a href="#">Dashboard</a>
    <a href="#">Products</a>
    <a href="#">Orders</a>
    <a href="#">Users</a>
    <a href="#">Settings</a>
</nav>

<main>

<div class="card">
    <h2>Dashboard</h2>
    <p>Welcome, Admin! Use this panel to manage your website.</p>
</div>

<div class="card">
    <h2>Add New Product</h2>
    <form id="addProductForm">
        <label for="productName">Product Name</label>
        <input type="text" id="productName" name="productName" placeholder="Enter product name" required>

        <label for="description">Description</label>
        <textarea id="description" name="description" placeholder="Enter product description" required></textarea>

        <label for="price">Price</label>
        <input type="number" id="price" name="price" placeholder="Enter price" required>

        <label for="category">Category</label>
        <select id="category" name="category" required>
            <option value="shirts">Shirts</option>
            <option value="pants">Pants</option>
            <option value="shoes">Shoes</option>
        </select>

        <button type="submit">Add Product</button>
    </form>
</div>

<div class="card">
    <h2>Products List</h2>
    <div id="productsContainer">Loading products...</div>
</div>

</main>

<script>
// Fetch products from Netlify function
async function fetchProducts() {
    try {
        const response = await fetch("/.netlify/functions/getProducts");
        const products = await response.json();
        const container = document.getElementById("productsContainer");
        if(products.length === 0) container.innerHTML = "No products found.";
        else {
            container.innerHTML = products.map(p => `
                <div>
                    <strong>${p.name}</strong> - $${p.price} <br>
                    ${p.description} <br>
                    Category: ${p.category}
                </div>
            `).join('');
        }
    } catch (err) {
        console.error(err);
        document.getElementById("productsContainer").innerHTML = "Error loading products.";
    }
}
fetchProducts();

// Handle Add Product form submission
document.getElementById("addProductForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const product = {
        name: document.getElementById("productName").value,
        description: document.getElementById("description").value,
        price: document.getElementById("price").value,
        category: document.getElementById("category").value
    };

    try {
        const res = await fetch("/.netlify/functions/addProduct", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(product)
        });
        const data = await res.json();
        alert(data.message);
        fetchProducts(); // refresh products list
        e.target.reset(); // clear form
    } catch (err) {
        console.error(err);
        alert("Error adding product");
    }
});
</script>

</body>
</html>
